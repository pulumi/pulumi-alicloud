// *** WARNING: this file was generated by pulumi-language-java. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

package com.pulumi.alicloud.cs;

import com.pulumi.alicloud.Utilities;
import com.pulumi.alicloud.cs.AutoscalingConfigArgs;
import com.pulumi.alicloud.cs.inputs.AutoscalingConfigState;
import com.pulumi.core.Output;
import com.pulumi.core.annotations.Export;
import com.pulumi.core.annotations.ResourceType;
import com.pulumi.core.internal.Codegen;
import java.lang.Boolean;
import java.lang.Integer;
import java.lang.String;
import java.util.Map;
import java.util.Optional;
import javax.annotation.Nullable;

/**
 * This resource will help you configure auto scaling for the kubernetes cluster, see [What is autoscaling config](https://www.alibabacloud.com/help/en/ack/ack-managed-and-ack-dedicated/developer-reference/api-configure-auto-scaling).
 * 
 * &gt; **NOTE:** Available since v1.127.0.
 * 
 * &gt; **NOTE:** From version 1.164.0, support for specifying whether to allow the scale-in of nodes by parameter `scaleDownEnabled`.
 * 
 * &gt; **NOTE:** From version 1.164.0, support for selecting the policy for selecting which node pool to scale by parameter `expander`.
 * 
 * &gt; **NOTE:** From version 1.237.0, support for selecting the type of autoscaler by parameter `scalerType`.
 * 
 * &gt; **NOTE:** From version 1.256.0, support for setting the priority of scaling groups by parameter `priorities`.
 * 
 * ## Example Usage
 * 
 * If you do not have an existing cluster, you need to create an ACK cluster through alicloud.cs.ManagedKubernetes first, and then configure automatic scaling.
 * 
 * Basic Usage
 * 
 * <pre>
 * {@code
 * package generated_program;
 * 
 * import com.pulumi.Context;
 * import com.pulumi.Pulumi;
 * import com.pulumi.core.Output;
 * import com.pulumi.alicloud.AlicloudFunctions;
 * import com.pulumi.alicloud.inputs.GetZonesArgs;
 * import com.pulumi.alicloud.ecs.EcsFunctions;
 * import com.pulumi.alicloud.ecs.inputs.GetInstanceTypesArgs;
 * import com.pulumi.alicloud.vpc.Network;
 * import com.pulumi.alicloud.vpc.NetworkArgs;
 * import com.pulumi.alicloud.vpc.Switch;
 * import com.pulumi.alicloud.vpc.SwitchArgs;
 * import com.pulumi.alicloud.cs.ManagedKubernetes;
 * import com.pulumi.alicloud.cs.ManagedKubernetesArgs;
 * import com.pulumi.std.StdFunctions;
 * import com.pulumi.std.inputs.CidrsubnetArgs;
 * import com.pulumi.alicloud.cs.NodePool;
 * import com.pulumi.alicloud.cs.NodePoolArgs;
 * import com.pulumi.alicloud.cs.inputs.NodePoolScalingConfigArgs;
 * import com.pulumi.std.inputs.FormatArgs;
 * import com.pulumi.alicloud.cs.AutoscalingConfig;
 * import com.pulumi.alicloud.cs.AutoscalingConfigArgs;
 * import com.pulumi.std.inputs.JoinArgs;
 * import com.pulumi.codegen.internal.KeyedValue;
 * import java.util.List;
 * import java.util.ArrayList;
 * import java.util.Map;
 * import java.io.File;
 * import java.nio.file.Files;
 * import java.nio.file.Paths;
 * 
 * public class App {
 *     public static void main(String[] args) {
 *         Pulumi.run(App::stack);
 *     }
 * 
 *     public static void stack(Context ctx) {
 *         final var config = ctx.config();
 *         final var name = config.get("name").orElse("terraform-example");
 *         final var default = AlicloudFunctions.getZones(GetZonesArgs.builder()
 *             .availableResourceCreation("VSwitch")
 *             .build());
 * 
 *         final var defaultGetInstanceTypes = EcsFunctions.getInstanceTypes(GetInstanceTypesArgs.builder()
 *             .availabilityZone(default_.zones()[0].id())
 *             .cpuCoreCount(4)
 *             .memorySize(8)
 *             .kubernetesNodeRole("Worker")
 *             .systemDiskCategory("cloud_essd")
 *             .build());
 * 
 *         var defaultNetwork = new Network("defaultNetwork", NetworkArgs.builder()
 *             .vpcName(name)
 *             .cidrBlock("10.4.0.0/16")
 *             .build());
 * 
 *         var defaultSwitch = new Switch("defaultSwitch", SwitchArgs.builder()
 *             .vswitchName(name)
 *             .cidrBlock("10.4.0.0/24")
 *             .vpcId(defaultNetwork.id())
 *             .zoneId(default_.zones()[0].id())
 *             .build());
 * 
 *         var defaultManagedKubernetes = new ManagedKubernetes("defaultManagedKubernetes", ManagedKubernetesArgs.builder()
 *             .namePrefix(name)
 *             .clusterSpec("ack.pro.small")
 *             .workerVswitchIds(defaultSwitch.id())
 *             .newNatGateway(true)
 *             .podCidr(StdFunctions.cidrsubnet(CidrsubnetArgs.builder()
 *                 .input("10.0.0.0/8")
 *                 .newbits(8)
 *                 .netnum(36)
 *                 .build()).result())
 *             .serviceCidr(StdFunctions.cidrsubnet(CidrsubnetArgs.builder()
 *                 .input("172.16.0.0/16")
 *                 .newbits(4)
 *                 .netnum(7)
 *                 .build()).result())
 *             .slbInternetEnabled(true)
 *             .build());
 * 
 *         for (var i = 0; i < 3; i++) {
 *             new NodePool("defaultNodePool-" + i, NodePoolArgs.builder()
 *                 .nodePoolName(StdFunctions.format(FormatArgs.builder()
 *                     .input("%s-%d")
 *                     .args(                    
 *                         name,
 *                         range.value())
 *                     .build()).result())
 *                 .clusterId(defaultManagedKubernetes.id())
 *                 .vswitchIds(defaultSwitch.id())
 *                 .instanceTypes(defaultGetInstanceTypes.instanceTypes()[0].id())
 *                 .systemDiskCategory("cloud_essd")
 *                 .systemDiskSize(40)
 *                 .imageType("AliyunLinux3")
 *                 .scalingConfig(NodePoolScalingConfigArgs.builder()
 *                     .enable(true)
 *                     .minSize(0)
 *                     .maxSize(10)
 *                     .build())
 *                 .build());
 * 
 *         
 * }
 *         var defaultAutoscalingConfig = new AutoscalingConfig("defaultAutoscalingConfig", AutoscalingConfigArgs.builder()
 *             .clusterId(defaultManagedKubernetes.id())
 *             .coolDownDuration("10m")
 *             .unneededDuration("10m")
 *             .utilizationThreshold("0.5")
 *             .gpuUtilizationThreshold("0.5")
 *             .scanInterval("30s")
 *             .scaleDownEnabled(true)
 *             .expander("priority")
 *             .skipNodesWithSystemPods(true)
 *             .skipNodesWithLocalStorage(false)
 *             .daemonsetEvictionForNodes(false)
 *             .maxGracefulTerminationSec(14400)
 *             .minReplicaCount(0)
 *             .recycleNodeDeletionEnabled(false)
 *             .scaleUpFromZero(true)
 *             .scalerType("cluster-autoscaler")
 *             .priorities(Map.ofEntries(
 *                 Map.entry("10", StdFunctions.join(JoinArgs.builder()
 *                     .separator(",")
 *                     .input(                    
 *                         defaultNodePool[0].scalingGroupId(),
 *                         defaultNodePool[1].scalingGroupId())
 *                     .build()).applyValue(_invoke -> _invoke.result())),
 *                 Map.entry("20", defaultNodePool[2].scalingGroupId())
 *             ))
 *             .build());
 * 
 *     }
 * }
 * }
 * </pre>
 * 
 */
@ResourceType(type="alicloud:cs/autoscalingConfig:AutoscalingConfig")
public class AutoscalingConfig extends com.pulumi.resources.CustomResource {
    /**
     * The id of kubernetes cluster.
     * 
     */
    @Export(name="clusterId", refs={String.class}, tree="[0]")
    private Output</* @Nullable */ String> clusterId;

    /**
     * @return The id of kubernetes cluster.
     * 
     */
    public Output<Optional<String>> clusterId() {
        return Codegen.optional(this.clusterId);
    }
    /**
     * Specify the time interval between detecting a scale-in requirement (when the threshold is reached) and actually executing the scale-in operation (reducing the number of Pods). Default is `10m`. If the delay (cooldown) value is set too long, there could be complaints that the Horizontal Pod Autoscaler is not responsive to workload changes. However, if the delay value is set too short, the scale of the replicas set may keep thrashing as usual.
     * 
     */
    @Export(name="coolDownDuration", refs={String.class}, tree="[0]")
    private Output</* @Nullable */ String> coolDownDuration;

    /**
     * @return Specify the time interval between detecting a scale-in requirement (when the threshold is reached) and actually executing the scale-in operation (reducing the number of Pods). Default is `10m`. If the delay (cooldown) value is set too long, there could be complaints that the Horizontal Pod Autoscaler is not responsive to workload changes. However, if the delay value is set too short, the scale of the replicas set may keep thrashing as usual.
     * 
     */
    public Output<Optional<String>> coolDownDuration() {
        return Codegen.optional(this.coolDownDuration);
    }
    /**
     * If true DaemonSet pods will be  terminated from nodes. Default is `false`.
     * 
     */
    @Export(name="daemonsetEvictionForNodes", refs={Boolean.class}, tree="[0]")
    private Output</* @Nullable */ Boolean> daemonsetEvictionForNodes;

    /**
     * @return If true DaemonSet pods will be  terminated from nodes. Default is `false`.
     * 
     */
    public Output<Optional<Boolean>> daemonsetEvictionForNodes() {
        return Codegen.optional(this.daemonsetEvictionForNodes);
    }
    /**
     * The policy for selecting which node pool to scale. Valid values: `least-waste`, `random`, `priority`. For scaler type `goatscaler`, only the `least-waste` expander is currently supported. For more information on these policies, see [Configure auto scaling](https://www.alibabacloud.com/help/en/container-service-for-kubernetes/latest/auto-scaling-of-nodes#section-3bg-2ko-inl)
     * 
     */
    @Export(name="expander", refs={String.class}, tree="[0]")
    private Output</* @Nullable */ String> expander;

    /**
     * @return The policy for selecting which node pool to scale. Valid values: `least-waste`, `random`, `priority`. For scaler type `goatscaler`, only the `least-waste` expander is currently supported. For more information on these policies, see [Configure auto scaling](https://www.alibabacloud.com/help/en/container-service-for-kubernetes/latest/auto-scaling-of-nodes#section-3bg-2ko-inl)
     * 
     */
    public Output<Optional<String>> expander() {
        return Codegen.optional(this.expander);
    }
    /**
     * The scale-in threshold for GPU instance. Default is `0.5`.
     * 
     */
    @Export(name="gpuUtilizationThreshold", refs={String.class}, tree="[0]")
    private Output</* @Nullable */ String> gpuUtilizationThreshold;

    /**
     * @return The scale-in threshold for GPU instance. Default is `0.5`.
     * 
     */
    public Output<Optional<String>> gpuUtilizationThreshold() {
        return Codegen.optional(this.gpuUtilizationThreshold);
    }
    /**
     * Maximum number of seconds CA waits for pod termination when trying to scale down a node. Default is `14400`.
     * 
     */
    @Export(name="maxGracefulTerminationSec", refs={Integer.class}, tree="[0]")
    private Output</* @Nullable */ Integer> maxGracefulTerminationSec;

    /**
     * @return Maximum number of seconds CA waits for pod termination when trying to scale down a node. Default is `14400`.
     * 
     */
    public Output<Optional<Integer>> maxGracefulTerminationSec() {
        return Codegen.optional(this.maxGracefulTerminationSec);
    }
    /**
     * Minimum number of replicas that a replica set or replication controller should have to allow their pods deletion in scale down. Default is `0`.
     * 
     */
    @Export(name="minReplicaCount", refs={Integer.class}, tree="[0]")
    private Output</* @Nullable */ Integer> minReplicaCount;

    /**
     * @return Minimum number of replicas that a replica set or replication controller should have to allow their pods deletion in scale down. Default is `0`.
     * 
     */
    public Output<Optional<Integer>> minReplicaCount() {
        return Codegen.optional(this.minReplicaCount);
    }
    /**
     * Priority settings for autoscaling node pool scaling groups. This parameter only takes effect when `expander` is set to `priority`. Only supports scaler type `cluster-autoscaler`. Uses key-value pairs where the key is the priority value, and the value is a comma-separated list of scaling group IDs. High numerical values indicate higher priority.
     * 
     */
    @Export(name="priorities", refs={Map.class,String.class}, tree="[0,1,1]")
    private Output</* @Nullable */ Map<String,String>> priorities;

    /**
     * @return Priority settings for autoscaling node pool scaling groups. This parameter only takes effect when `expander` is set to `priority`. Only supports scaler type `cluster-autoscaler`. Uses key-value pairs where the key is the priority value, and the value is a comma-separated list of scaling group IDs. High numerical values indicate higher priority.
     * 
     */
    public Output<Optional<Map<String,String>>> priorities() {
        return Codegen.optional(this.priorities);
    }
    /**
     * Should CA delete the K8s node object when recycle node has scaled down successfully. Default is `false`.
     * 
     */
    @Export(name="recycleNodeDeletionEnabled", refs={Boolean.class}, tree="[0]")
    private Output</* @Nullable */ Boolean> recycleNodeDeletionEnabled;

    /**
     * @return Should CA delete the K8s node object when recycle node has scaled down successfully. Default is `false`.
     * 
     */
    public Output<Optional<Boolean>> recycleNodeDeletionEnabled() {
        return Codegen.optional(this.recycleNodeDeletionEnabled);
    }
    /**
     * Specify whether to allow the scale-in of nodes. Default is `true`.
     * 
     */
    @Export(name="scaleDownEnabled", refs={Boolean.class}, tree="[0]")
    private Output</* @Nullable */ Boolean> scaleDownEnabled;

    /**
     * @return Specify whether to allow the scale-in of nodes. Default is `true`.
     * 
     */
    public Output<Optional<Boolean>> scaleDownEnabled() {
        return Codegen.optional(this.scaleDownEnabled);
    }
    /**
     * Should CA scale up when there 0 ready nodes. Default is `true`.
     * 
     */
    @Export(name="scaleUpFromZero", refs={Boolean.class}, tree="[0]")
    private Output</* @Nullable */ Boolean> scaleUpFromZero;

    /**
     * @return Should CA scale up when there 0 ready nodes. Default is `true`.
     * 
     */
    public Output<Optional<Boolean>> scaleUpFromZero() {
        return Codegen.optional(this.scaleUpFromZero);
    }
    /**
     * The type of autoscaler. Valid values: `cluster-autoscaler`, `goatscaler`. For cluster version 1.22 and below, we only support `cluster-autoscaler`. When switching from `cluster-autoscaler` to `goatscaler`, all configuration parameters will be automatically migrated.
     * 
     */
    @Export(name="scalerType", refs={String.class}, tree="[0]")
    private Output</* @Nullable */ String> scalerType;

    /**
     * @return The type of autoscaler. Valid values: `cluster-autoscaler`, `goatscaler`. For cluster version 1.22 and below, we only support `cluster-autoscaler`. When switching from `cluster-autoscaler` to `goatscaler`, all configuration parameters will be automatically migrated.
     * 
     */
    public Output<Optional<String>> scalerType() {
        return Codegen.optional(this.scalerType);
    }
    /**
     * The interval at which the cluster is reevaluated for scaling. Default is `30s`.
     * 
     */
    @Export(name="scanInterval", refs={String.class}, tree="[0]")
    private Output</* @Nullable */ String> scanInterval;

    /**
     * @return The interval at which the cluster is reevaluated for scaling. Default is `30s`.
     * 
     */
    public Output<Optional<String>> scanInterval() {
        return Codegen.optional(this.scanInterval);
    }
    /**
     * If true cluster autoscaler will never delete nodes with pods with local storage, e.g. EmptyDir or HostPath. Default is `false`.
     * 
     */
    @Export(name="skipNodesWithLocalStorage", refs={Boolean.class}, tree="[0]")
    private Output</* @Nullable */ Boolean> skipNodesWithLocalStorage;

    /**
     * @return If true cluster autoscaler will never delete nodes with pods with local storage, e.g. EmptyDir or HostPath. Default is `false`.
     * 
     */
    public Output<Optional<Boolean>> skipNodesWithLocalStorage() {
        return Codegen.optional(this.skipNodesWithLocalStorage);
    }
    /**
     * If true cluster autoscaler will never delete nodes with pods from kube-system (except for DaemonSet or mirror pods). Default is `true`.
     * 
     */
    @Export(name="skipNodesWithSystemPods", refs={Boolean.class}, tree="[0]")
    private Output</* @Nullable */ Boolean> skipNodesWithSystemPods;

    /**
     * @return If true cluster autoscaler will never delete nodes with pods from kube-system (except for DaemonSet or mirror pods). Default is `true`.
     * 
     */
    public Output<Optional<Boolean>> skipNodesWithSystemPods() {
        return Codegen.optional(this.skipNodesWithSystemPods);
    }
    /**
     * Specify the time interval during which autoscaler does not perform scale-in operations after the most recent scale-out completion. Nodes added through scale-out can only be considered for scale-in after the period has elapsed. Default is `10m`.
     * 
     */
    @Export(name="unneededDuration", refs={String.class}, tree="[0]")
    private Output</* @Nullable */ String> unneededDuration;

    /**
     * @return Specify the time interval during which autoscaler does not perform scale-in operations after the most recent scale-out completion. Nodes added through scale-out can only be considered for scale-in after the period has elapsed. Default is `10m`.
     * 
     */
    public Output<Optional<String>> unneededDuration() {
        return Codegen.optional(this.unneededDuration);
    }
    /**
     * The scale-in a threshold. Default is `0.5`.
     * 
     */
    @Export(name="utilizationThreshold", refs={String.class}, tree="[0]")
    private Output</* @Nullable */ String> utilizationThreshold;

    /**
     * @return The scale-in a threshold. Default is `0.5`.
     * 
     */
    public Output<Optional<String>> utilizationThreshold() {
        return Codegen.optional(this.utilizationThreshold);
    }

    /**
     *
     * @param name The _unique_ name of the resulting resource.
     */
    public AutoscalingConfig(java.lang.String name) {
        this(name, AutoscalingConfigArgs.Empty);
    }
    /**
     *
     * @param name The _unique_ name of the resulting resource.
     * @param args The arguments to use to populate this resource's properties.
     */
    public AutoscalingConfig(java.lang.String name, @Nullable AutoscalingConfigArgs args) {
        this(name, args, null);
    }
    /**
     *
     * @param name The _unique_ name of the resulting resource.
     * @param args The arguments to use to populate this resource's properties.
     * @param options A bag of options that control this resource's behavior.
     */
    public AutoscalingConfig(java.lang.String name, @Nullable AutoscalingConfigArgs args, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        super("alicloud:cs/autoscalingConfig:AutoscalingConfig", name, makeArgs(args, options), makeResourceOptions(options, Codegen.empty()), false);
    }

    private AutoscalingConfig(java.lang.String name, Output<java.lang.String> id, @Nullable AutoscalingConfigState state, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        super("alicloud:cs/autoscalingConfig:AutoscalingConfig", name, state, makeResourceOptions(options, id), false);
    }

    private static AutoscalingConfigArgs makeArgs(@Nullable AutoscalingConfigArgs args, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        if (options != null && options.getUrn().isPresent()) {
            return null;
        }
        return args == null ? AutoscalingConfigArgs.Empty : args;
    }

    private static com.pulumi.resources.CustomResourceOptions makeResourceOptions(@Nullable com.pulumi.resources.CustomResourceOptions options, @Nullable Output<java.lang.String> id) {
        var defaultOptions = com.pulumi.resources.CustomResourceOptions.builder()
            .version(Utilities.getVersion())
            .build();
        return com.pulumi.resources.CustomResourceOptions.merge(defaultOptions, options, id);
    }

    /**
     * Get an existing Host resource's state with the given name, ID, and optional extra
     * properties used to qualify the lookup.
     *
     * @param name The _unique_ name of the resulting resource.
     * @param id The _unique_ provider ID of the resource to lookup.
     * @param state
     * @param options Optional settings to control the behavior of the CustomResource.
     */
    public static AutoscalingConfig get(java.lang.String name, Output<java.lang.String> id, @Nullable AutoscalingConfigState state, @Nullable com.pulumi.resources.CustomResourceOptions options) {
        return new AutoscalingConfig(name, id, state, options);
    }
}
